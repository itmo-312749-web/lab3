<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c='http://java.sun.com/jsp/jstl/core'>
<ui:composition template="layout/base.xhtml">
  <!-- head -->
  <ui:define name='additional-styles'>
    <h:outputStylesheet library='css' name='main.css'/>
  </ui:define>
  <ui:define name="page-title">Dot Service</ui:define>

  <!-- body -->
  <ui:param name='activePage' value='main'/>
  <ui:define name="content">
    <p:remoteCommand name="asyncPointCheck" action="#{mainView.exec()}" oncomplete="afterPointCheck(args)"/>

    <div class='row flex-wrap'>
      <div id='plot-wrapper' class='col'>
        <ui:include src='layout/components/plot.xhtml'/>
      </div>
      <div id='controls' class='col mt-3 mb-3'>

        <p:messages id="msgs"/>

        <div class='input-group mb-3 flex-nowrap'>
          <div class='col input-group flex-nowrap'>
            <p:outputLabel class='input-group-text p-2' for='x' value='X'/>
            <p:selectOneMenu id='x' styleClass='form-control' required='true' value='#{computeService.currentX}'>
              <f:selectItem itemValue='-5' itemLabel='-5'/>
              <f:selectItem itemValue='-4' itemLabel='-4'/>
              <f:selectItem itemValue='-3' itemLabel='-3'/>
              <f:selectItem itemValue='-2' itemLabel='-2'/>
              <f:selectItem itemValue='-1' itemLabel='-1'/>
              <f:selectItem itemValue='0' itemLabel='0'/>
              <f:selectItem itemValue='1' itemLabel='1'/>
              <f:selectItem itemValue='2' itemLabel='2'/>
              <f:selectItem itemValue='3' itemLabel='3'/>
              <f:selectItem itemValue='4' itemLabel='4'/>
              <f:selectItem itemValue='5' itemLabel='5'/>
              <f:validateLongRange minimum='-5' maximum='5'/>
            </p:selectOneMenu>
          </div>
        </div>
        <div class='input-group mb-3'>
          <p:outputLabel styleClass='input-group-text p-2' for='y' value='Y'/>
          <p:inputText id="y" styleClass='y-input form-control' placeholder='[ -3 ; 3 ]'
                       required='true' value='#{computeService.currentY}'>
            <f:validateDoubleRange minimum='-3' maximum='3'/>
          </p:inputText>
        </div>
        <div class='row'>
          <div class='col input-group flex-nowrap'>
            <p:outputLabel class='input-group-text p-2' for='r' value='R'/>
            <p:selectOneMenu id='r' styleClass='form-control' required='true' value='#{computeService.currentR}'>
              <f:selectItem itemValue='1' itemLabel='1'/>
              <f:selectItem itemValue='2' itemLabel='2'/>
              <f:selectItem itemValue='3' itemLabel='3'/>
              <f:selectItem itemValue='4' itemLabel='4'/>
              <f:selectItem itemValue='5' itemLabel='5'/>
              <f:validateLongRange minimum='1' maximum='5'/>
            </p:selectOneMenu>
          </div>

          <div class='col input-group'>
            <p:commandButton styleClass='form-control' value="Submit" update="@form"
                             action='#{computeService.computeCurrentAdnPersist}' oncomplete=''/>
          </div>
        </div>
      </div>
    </div>
    <div class='row'>
      <div class="col-md-12">
        <table class="table table-striped table-hover">
          <thead>
          <tr>
            <th scope="col">x</th>
            <th scope="col">y</th>
            <th scope="col">r</th>
            <th scope="col">Entry</th>
            <th scope="col">Execution time</th>
            <th scope="col">Timestamp</th>
          </tr>
          </thead>
          <tbody>
          <ui:repeat id='results' value="#{resultService.resultList}" var="result">
            <tr>
              <td>#{result.x}</td>
              <td>#{result.y}</td>
              <td>#{result.r}</td>
              <td>#{result.hit ? "Yes" : "No"}</td>
              <td>#{result.executionTime / 1e3} (us)</td>
              <td>#{result.getHumanReadableTimestamp()}</td>
            </tr>
          </ui:repeat>
          </tbody>
        </table>
      </div>
    </div>
  </ui:define>
</ui:composition>
</html>